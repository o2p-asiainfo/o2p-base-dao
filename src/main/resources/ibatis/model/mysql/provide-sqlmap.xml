<?xml version="1.0" encoding="UTF-8" ?>

<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN"
    "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="provide">

<!-- 插入组件信息 -->
 <insert id="insertComponent" 
 	parameterClass="com.ailk.eaap.op2.bo.Component">
 	<selectKey resultClass="String" keyProperty="componentId">
			SELECT nextval('SEQ_COMPONENT');
	 </selectKey>
    insert into component
	  (REG_TIME,STATE_TIME  
	  <dynamic >
	    <isNotNull prepend="," property="componentId">COMPONENT_ID</isNotNull>
        <isNotNull prepend="," property="orgId">ORG_ID</isNotNull>
        <isNotNull prepend="," property="code">CODE</isNotNull>
	    <isNotNull prepend="," property="name">NAME</isNotNull>
	    <isNotNull prepend="," property="componentTypeId">COMPONENT_TYPE_ID</isNotNull>
	    <isNotNull prepend="," property="sfileId">S_FILE_ID</isNotNull>
	    <isNotNull prepend="," property="descriptor">DESCRIPTOR</isNotNull>
	    <isNotNull prepend="," property="state">STATE</isNotNull>
	    <isNotNull prepend="," property="password">PASSWORD</isNotNull>
	    <isNotNull prepend="," property="tenantId"> TENANT_ID</isNotNull>
	  </dynamic>
	  )
	  values
	  (utc_timestamp(), utc_timestamp() 
	   <dynamic >
	    <isNotNull prepend="," property="componentId">#componentId#</isNotNull>
        <isNotNull prepend="," property="orgId">#orgId#</isNotNull>
        <isNotNull prepend="," property="code">#code#</isNotNull>
	    <isNotNull prepend="," property="name">#name#</isNotNull>
	    <isNotNull prepend="," property="componentTypeId">#componentTypeId#</isNotNull>
	    <isNotNull prepend="," property="sfileId">#sfileId#</isNotNull>
	    <isNotNull prepend="," property="descriptor">#descriptor#</isNotNull>
	    <isNotNull prepend="," property="state">#state#</isNotNull>
	    <isNotNull prepend="," property="password">#password#</isNotNull>
	    <isNotNull prepend="," property="tenantId">#tenantId#</isNotNull>
	   </dynamic>
	     )
</insert>
<delete id="deleteComponent" parameterClass="java.util.HashMap">
  delete from component where COMPONENT_ID=#value# and TENANT_ID = #tenantId#
</delete>

<update id="updateComponent" parameterClass="com.ailk.eaap.op2.bo.Component">
  update component
  <dynamic prepend="set">
    <isNotNull prepend="," property="orgId">ORG_ID=#orgId#</isNotNull>
    <isNotNull prepend="," property="code">CODE=#code#</isNotNull>
    <isNotNull prepend="," property="name">NAME=#name#</isNotNull>
    <isNotNull prepend="," property="componentTypeId">COMPONENT_TYPE_ID=#componentTypeId#</isNotNull>
    <isNotNull prepend="," property="regTime">REG_TIME=#regTime#</isNotNull>
    <isNotNull prepend="," property="state">STATE=#state#</isNotNull>
    <isNotNull prepend="," property="stateTime">STATE_TIME=#stateTime#</isNotNull>
    <isNotNull prepend="," property="password">PASSWORD=#password#</isNotNull>
    <isNotNull prepend="," property="sfileId">S_FILE_ID=#sfileId#</isNotNull>
    <isNotNull prepend="," property="descriptor">DESCRIPTOR=#descriptor#</isNotNull>
    <isNotNull prepend="," property="upState">UP_STATE=#upState#</isNotNull>
  </dynamic>
  <dynamic prepend="where">
    <isNotNull prepend="and" property="componentId">COMPONENT_ID=#componentId#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</update>

<select id="selectComponent" parameterClass="com.ailk.eaap.op2.bo.Component" resultClass="com.ailk.eaap.op2.bo.Component">
  select COMPONENT_ID COMPONENTID,ORG_ID ORGID,CODE CODE,NAME NAME,COMPONENT_TYPE_ID COMPONENTTYPEID,STATE STATE,
  STATE_TIME STATETIME, PASSWORD PASSWORD,REG_TIME REGTIME, S_FILE_ID SFILEID, DESCRIPTOR DESCRIPTOR,UP_STATE UPSTATE from component
  <dynamic prepend="where">
    <isNotNull prepend="and" property="componentId"> COMPONENT_ID=#componentId#</isNotNull>
    <isNotNull prepend="and" property="orgId"> ORG_ID=#orgId#</isNotNull>
    <isNotNull prepend="and" property="code"> CODE=#code#</isNotNull>
    <isNotNull prepend="and" property="name"> NAME=#name#</isNotNull>
    <isNotNull prepend="and" property="componentTypeId"> COMPONENT_TYPE_ID=#componentTypeId#</isNotNull>
    <isNotNull prepend="and" property="state"> STATE=#state#</isNotNull>
    <isNotNull prepend="and" property="stateTime"> STATE_TIME=#stateTime#</isNotNull>
    <isNotNull prepend="and" property="password"> PASSWORD=#password#</isNotNull>
    <isNotNull prepend="and" property="regTime"> REG_TIME=#regTime#</isNotNull>
    <isNotNull prepend="and" property="sfileId"> S_FILE_ID=#sfileId#</isNotNull>
    <isNotNull prepend="and" property="descriptor"> DESCRIPTOR=#descriptor#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</select>

<insert id="insertTechImpl" parameterClass="com.ailk.eaap.op2.bo.TechImpl">
<selectKey resultClass="int" keyProperty="techImplId">
	SELECT nextval('SEQ_TECH_IMPL');
  </selectKey>
   insert into tech_impl (REG_TIME,LAEST_TIME,TECH_IMPL_CODE
  <dynamic >
    <isNotNull prepend="," property="techImplId">TECH_IMPL_ID</isNotNull>
    <isNotNull prepend="," property="techImplName">TECH_IMPL_NAME</isNotNull>
    <isNotNull prepend="," property="techImpConPoId">TECH_IMP_CON_PO_ID</isNotNull>
    <isNotNull prepend="," property="componentId">COMPONENT_ID</isNotNull>
    <isNotNull prepend="," property="commProCd">COMM_PRO_CD</isNotNull>
     <isNotNull prepend="," property="usealbeState">USEALBE_STATE</isNotNull>
     <isNotNull prepend="," property="tenantId"> TENANT_ID</isNotNull>
  </dynamic>
  )
  values
  (utc_timestamp(),utc_timestamp(),uuid()
  <dynamic >
    <isNotNull prepend="," property="techImplId">#techImplId#</isNotNull>
    <isNotNull prepend="," property="techImplName">#techImplName#</isNotNull>
    <isNotNull prepend="," property="techImpConPoId">#techImpConPoId#</isNotNull>
    <isNotNull prepend="," property="componentId">#componentId#</isNotNull>
    <isNotNull prepend="," property="commProCd">case when #commProCd# = '' then null else #commProCd# end</isNotNull>
    <isNotNull prepend="," property="usealbeState">#usealbeState#</isNotNull>
    <isNotNull prepend="," property="tenantId">#tenantId#</isNotNull>
  </dynamic>
  )
</insert>
<delete id="deleteTechImpl" parameterClass="com.ailk.eaap.op2.bo.TechImpl">
  delete from tech_impl
  <dynamic prepend="where">
    <isNotNull prepend="and" property="techImplId">TECH_IMPL_ID=#techImplId#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</delete>
<update id="updateTechImpl" parameterClass="com.ailk.eaap.op2.bo.TechImpl">
  update tech_impl
  <dynamic prepend="set">
    <isNotNull prepend="," property="techImplName">TECH_IMPL_NAME=#techImplName#</isNotNull>
    <isNotNull prepend="," property="techImpConPoId">TECH_IMP_CON_PO_ID=#techImpConPoId#</isNotNull>
    <isNotNull prepend="," property="componentId">COMPONENT_ID=#componentId#</isNotNull>
    <isNotNull prepend="," property="commProCd">COMM_PRO_CD=#commProCd#</isNotNull>
    <isNotNull prepend="," property="regTime">REG_TIME=#regTime#</isNotNull>
    <isNotNull prepend="," property="usealbeState">USEALBE_STATE=#usealbeState#</isNotNull>
    <isNotNull prepend="," property="laestTime">LAEST_TIME=#laestTime#</isNotNull>
  </dynamic>
  <dynamic prepend="where">
    <isNotNull prepend="and" property="techImplId">TECH_IMPL_ID=#techImplId#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</update>
<select id="selectTechImpl" parameterClass="com.ailk.eaap.op2.bo.TechImpl" resultClass="com.ailk.eaap.op2.bo.TechImpl">
  select * from tech_impl
  <dynamic prepend="where">
    <isNotNull prepend="and" property="techImplId"> TECH_IMPL_ID=#techImplId#</isNotNull>
    <isNotNull prepend="and" property="techImpConPoId"> TECH_IMP_CON_PO_ID=#techImpConPoId#</isNotNull>
    <isNotNull prepend="and" property="componentId"> COMPONENT_ID=#componentId#</isNotNull>
    <isNotNull prepend="and" property="commProCd"> COMM_PRO_CD=#commProCd#</isNotNull>
    <isNotNull prepend="and" property="regTime"> REG_TIME=#regTime#</isNotNull>
    <isNotNull prepend="and" property="usealbeState"> USEALBE_STATE=#usealbeState#</isNotNull>
    <isNotNull prepend="and" property="laestTime"> LAEST_TIME=#laestTime#</isNotNull>
    <isNotNull prepend="and" property="techImplName"> TECH_IMPL_NAME=#techImplName#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</select>

<delete id="deleteTechImpAtt" parameterClass="com.ailk.eaap.op2.bo.TechImpAtt">
  delete from tech_imp_att
  <dynamic prepend="where">
    <isNotNull prepend="and" property="techImpAttId">TECH_IMP_ATT_ID=#techImpAttId#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</delete>
<update id="updateTechImpAtt" parameterClass="com.ailk.eaap.op2.bo.TechImpAtt">
  update tech_imp_att
  <dynamic prepend="set">
    <isNotNull prepend="," property="attrSpecId">ATTR_SPEC_ID=#attrSpecId#</isNotNull>
    <isNotNull prepend="," property="techImplId">TECH_IMPL_ID=#techImplId#</isNotNull>
    <isNotNull prepend="," property="attrSpecValue">ATTR_SPEC_VALUE=#attrSpecValue#</isNotNull>
    <isNotNull prepend="," property="createTime">CREATE_TIME=#createTime#</isNotNull>
    <isNotNull prepend="," property="lastestTime">LASTEST_TIME=#lastestTime#</isNotNull>
    <isNotNull prepend="," property="state">STATE=#state#</isNotNull>
  </dynamic>
  <dynamic prepend="where">
    <isNotNull prepend="and" property="techImpAttId">TECH_IMP_ATT_ID=#techImpAttId#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</update>

<select id="selectTechImpAtt" parameterClass="com.ailk.eaap.op2.bo.TechImpAtt" resultClass="com.ailk.eaap.op2.bo.TechImpAtt">
  select TECH_IMP_ATT_ID TECHIMPATTID, ATTR_SPEC_ID ATTRSPECID,TECH_IMPL_ID TECHIMPLID,ATTR_SPEC_VALUE ATTRSPECVALUE, 
  CREATE_TIME CREATETIME,LASTEST_TIME LASTESTTIME, STATE STATE from tech_imp_att
  <dynamic prepend="where">
    <isNotNull prepend="and" property="techImpAttId"> TECH_IMP_ATT_ID=#techImpAttId#</isNotNull>
    <isNotNull prepend="and" property="attrSpecId"> ATTR_SPEC_ID=#attrSpecId#</isNotNull>
    <isNotNull prepend="and" property="techImplId"> TECH_IMPL_ID=#techImplId#</isNotNull>
    <isNotNull prepend="and" property="attrSpecValue"> ATTR_SPEC_VALUE=#attrSpecValue#</isNotNull>
    <isNotNull prepend="and" property="createTime"> CREATE_TIME=#createTime#</isNotNull>
    <isNotNull prepend="and" property="lastestTime"> LASTEST_TIME=#lastestTime#</isNotNull>
    <isNotNull prepend="and" property="state"> STATE=#state#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</select>
<insert id="insertTechImpAtt" parameterClass="com.ailk.eaap.op2.bo.TechImpAtt">
	 <selectKey resultClass="int" keyProperty="techImpAttId">
	        SELECT nextval('SEQ_TECH_IMP_ATT');
	 </selectKey>
    insert into tech_imp_att (CREATE_TIME,LASTEST_TIME 
  <dynamic >
    <isNotNull prepend="," property="techImpAttId">TECH_IMP_ATT_ID</isNotNull>
    <isNotNull prepend="," property="attrSpecId">ATTR_SPEC_ID</isNotNull>
    <isNotNull prepend="," property="techImplId">TECH_IMPL_ID</isNotNull>
    <isNotNull prepend="," property="attrSpecValue">ATTR_SPEC_VALUE</isNotNull>
    <isNotNull prepend="," property="state">STATE</isNotNull>
    <isNotNull prepend="," property="tenantId"> TENANT_ID</isNotNull>
  </dynamic>
  )
  values (utc_timestamp(),utc_timestamp()
  <dynamic >
    <isNotNull prepend="," property="techImpAttId">#techImpAttId#</isNotNull>
    <isNotNull prepend="," property="attrSpecId">#attrSpecId#</isNotNull>
    <isNotNull prepend="," property="techImplId">#techImplId#</isNotNull>
    <isNotNull prepend="," property="attrSpecValue">#attrSpecValue#</isNotNull>
    <isNotNull prepend="," property="state">#state#</isNotNull>
    <isNotNull prepend="," property="tenantId">#tenantId#</isNotNull>
  </dynamic>
  )
</insert>

<delete id="deleteSerTechImpl" parameterClass="com.ailk.eaap.op2.bo.SerTechImpl">
  delete from ser_tech_impl
  <dynamic prepend="where">
    <isNotNull prepend="and" property="serTechImplId">SER_TECH_IMPL_ID=#serTechImplId#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</delete>
<update id="updateSerTechImpl" parameterClass="com.ailk.eaap.op2.bo.SerTechImpl">
  update ser_tech_impl
  <dynamic prepend="set">
    <isNotNull prepend="," property="serviceId">SERVICE_ID=#serviceId#</isNotNull>
    <isNotNull prepend="," property="techImplId">TECH_IMPL_ID=#techImplId#</isNotNull>
    <isNotNull prepend="," property="createTime">CREATE_TIME=#createTime#</isNotNull>
    <isNotNull prepend="," property="state">STATE=#state#</isNotNull>
    <isNotNull prepend="," property="lastestTime">LASTEST_TIME=#lastestTime#</isNotNull>
  </dynamic>
  <dynamic prepend="where">
    <isNotNull prepend="and" property="serTechImplId">SER_TECH_IMPL_ID=#serTechImplId#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</update>
<insert id="insertSerTechImpl" parameterClass="com.ailk.eaap.op2.bo.SerTechImpl">
  <selectKey resultClass="int" keyProperty="serTechImplId">
	SELECT nextval('SEQ_SER_TECH_IMPL');
  </selectKey>
    insert into ser_tech_impl (CREATE_TIME,LASTEST_TIME
  <dynamic >
  	<isNotNull prepend="," property="serTechImplId">SER_TECH_IMPL_ID</isNotNull>
    <isNotNull prepend="," property="serviceId">SERVICE_ID</isNotNull>
    <isNotNull prepend="," property="techImplId">TECH_IMPL_ID</isNotNull>
    <isNotNull prepend="," property="state">STATE</isNotNull>
    <isNotNull prepend="," property="tenantId"> TENANT_ID</isNotNull>
  </dynamic>
  )values (utc_timestamp(),utc_timestamp()
  <dynamic >
  	<isNotNull prepend="," property="serTechImplId">#serTechImplId#</isNotNull>
    <isNotNull prepend="," property="serviceId">#serviceId#</isNotNull>
    <isNotNull prepend="," property="techImplId">#techImplId#</isNotNull>
    <isNotNull prepend="," property="state">#state#</isNotNull>
    <isNotNull prepend="," property="tenantId">#tenantId#</isNotNull>
  </dynamic>
  )
</insert>

<select id="selectSerTechImpl" parameterClass="com.ailk.eaap.op2.bo.SerTechImpl" resultClass="com.ailk.eaap.op2.bo.SerTechImpl">
  select * from ser_tech_impl
  <dynamic prepend="where">
    <isNotNull prepend="and" property="serTechImplId">SER_TECH_IMPL_ID=#serTechImplId#</isNotNull>
    <isNotNull prepend="and" property="serviceId">SERVICE_ID=#serviceId#</isNotNull>
    <isNotNull prepend="and" property="techImplId">TECH_IMPL_ID=#techImplId#</isNotNull>
    <isNotNull prepend="and" property="createTime">CREATE_TIME=#createTime#</isNotNull>
    <isNotNull prepend="and" property="state">STATE=#state#</isNotNull>
    <isNotNull prepend="and" property="lastestTime">LASTEST_TIME=#lastestTime#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</select>
<delete id="deleteContract" parameterClass="com.ailk.eaap.op2.bo.Contract">
  delete from contract
  <dynamic prepend="where">
    <isNotNull prepend="and" property="contractId">CONTRACT_ID=#contractId#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</delete>
<update id="updateContract" parameterClass="com.ailk.eaap.op2.bo.Contract">
  update contract
  <dynamic prepend="set">
    <isNotNull prepend="," property="baseContractId">BASE_CONTRACT_ID=#baseContractId#</isNotNull>
    <isNull prepend="," property="baseContractId">BASE_CONTRACT_ID=null</isNull>
    <isNotNull prepend="," property="name">NAME=#name#</isNotNull>
    <isNotNull prepend="," property="code">CODE=#code#</isNotNull>
    <isNotNull prepend="," property="createTime">CREATE_TIME=#createTime#</isNotNull>
    <isNotNull prepend="," property="state">STATE=#state#</isNotNull>
    <isNotNull prepend="," property="lastestTime">LASTEST_TIME=#lastestTime#</isNotNull>
    <isNotNull prepend="," property="descriptor">DESCRIPTOR=#descriptor#</isNotNull>  
    <isNotNull prepend="," property="isBase">IS_BASE=#isBase#</isNotNull>
  </dynamic>
  <dynamic prepend="where">
    <isNotNull prepend="and" property="contractId">CONTRACT_ID=#contractId#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</update>

<insert id="insertContract" parameterClass="com.ailk.eaap.op2.bo.Contract" >
  <selectKey resultClass="int" keyProperty="contractId">
	SELECT nextval('SEQ_CONTRACT');
  </selectKey>
    insert into contract (CREATE_TIME,LASTEST_TIME
  <dynamic >
    <isNotNull prepend="," property="contractId">CONTRACT_ID</isNotNull>
  	<isNotNull prepend="," property="baseContractId">BASE_CONTRACT_ID</isNotNull>
  	<isNotNull prepend="," property="name">NAME</isNotNull>
    <isNotNull prepend="," property="code">CODE</isNotNull>
    <isNotNull prepend="," property="state">STATE</isNotNull>
    <isNotNull prepend="," property="descriptor">DESCRIPTOR</isNotNull>
    <isNotNull prepend="," property="isBase">IS_BASE</isNotNull>
    <isNotNull prepend="," property="tenantId">TENANT_ID</isNotNull>
  </dynamic>
  )values (utc_timestamp(),utc_timestamp()
  <dynamic >
    <isNotNull prepend="," property="contractId">#contractId#</isNotNull>
  	<isNotNull prepend="," property="baseContractId">#baseContractId#</isNotNull>
  	<isNotNull prepend="," property="name">#name#</isNotNull>
    <isNotNull prepend="," property="code">#code#</isNotNull>
    <isNotNull prepend="," property="state">#state#</isNotNull>
    <isNotNull prepend="," property="descriptor">#descriptor#</isNotNull>   
    <isNotNull prepend="," property="isBase">#isBase#</isNotNull>
    <isNotNull prepend="," property="tenantId">#tenantId#</isNotNull>
    
  </dynamic>
  )
</insert>
<select id="selectContract" parameterClass="com.ailk.eaap.op2.bo.Contract" resultClass="com.ailk.eaap.op2.bo.Contract">
  SELECT CONTRACT_ID CONTRACTID, BASE_CONTRACT_ID BASECONTRACTID, NAME NAME, CODE CODE,CREATE_TIME CREATETIME,STATE STATE, LASTEST_TIME LASTESTTIME, DESCRIPTOR DESCRIPTOR, IS_BASE ISBASE 
    from contract
  <dynamic prepend="where">
    <isNotNull prepend="and" property="contractId"> CONTRACT_ID=#contractId#</isNotNull>
    <isNotNull prepend="and" property="baseContractId"> BASE_CONTRACT_ID=#baseContractId#</isNotNull>
    <isNotNull prepend="and" property="name"> NAME=#name#</isNotNull>
    <isNotNull prepend="and" property="code"> CODE=#code#</isNotNull>
    <isNotNull prepend="and" property="createTime"> CREATE_TIME=#createTime#</isNotNull>
    <isNotNull prepend="and" property="state"> STATE=#state#</isNotNull>
    <isNotNull prepend="and" property="lastestTime"> LASTEST_TIME=#lastestTime#</isNotNull>
    <isNotNull prepend="and" property="descriptor"> DESCRIPTOR=#descriptor#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</select>
<delete id="deleteContractVersion" parameterClass="com.ailk.eaap.op2.bo.ContractVersion">
  delete from contract_version
  <dynamic prepend="where">
    <isNotNull prepend="and" property="contractVersionId">CONTRACT_VERSION_ID=#contractVersionId#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</delete>
<update id="updateContractVersion" parameterClass="com.ailk.eaap.op2.bo.ContractVersion">
  update contract_version
  <dynamic prepend="set">
    <isNotNull prepend="," property="contractId">CONTRACT_ID=#contractId#</isNotNull>
    <isNotNull prepend="," property="version">VERSION=#version#</isNotNull>
    <isNotNull prepend="," property="createTime">CREATE_TIME=#createTime#</isNotNull>
    <isNotNull prepend="," property="state">STATE=#state#</isNotNull>
    <isNotNull prepend="," property="lastestTime">LASTEST_TIME=#lastestTime#</isNotNull>
    <isNotNull prepend="," property="effDate">EFF_DATE=#effDate#</isNotNull>
    <isNotNull prepend="," property="expDate">EXP_DATE=#expDate#</isNotNull>
    <isNotNull prepend="," property="descriptor">DESCRIPTOR=#descriptor#</isNotNull>
    <isNotNull prepend="," property="isNeedCheck">IS_NEED_CHECK=#isNeedCheck#</isNotNull>
  </dynamic>
  <dynamic prepend="where">
    <isNotNull prepend="and" property="contractVersionId">CONTRACT_VERSION_ID=#contractVersionId#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</update>
<insert id="insertContractVersion" parameterClass="com.ailk.eaap.op2.bo.ContractVersion">
  <selectKey resultClass="int" keyProperty="contractVersionId">
	SELECT nextval('SEQ_CONTRACT_VERSION');
  </selectKey>
    insert into contract_version (CREATE_TIME,LASTEST_TIME,EFF_DATE,EXP_DATE
  <dynamic >
  	<isNotNull prepend="," property="contractVersionId">CONTRACT_VERSION_ID</isNotNull>
    <isNotNull prepend="," property="contractId">CONTRACT_ID</isNotNull>
    <isNotNull prepend="," property="version">VERSION</isNotNull>
    <isNotNull prepend="," property="state">STATE</isNotNull>
    <isNotNull prepend="," property="descriptor">DESCRIPTOR</isNotNull>
    <isNotNull prepend="," property="isNeedCheck">IS_NEED_CHECK</isNotNull>
    <isNotNull prepend="," property="tenantId">TENANT_ID</isNotNull>
    
  </dynamic>
 	)values (utc_timestamp(),utc_timestamp(),utc_timestamp(),STR_TO_DATE('3000-1-1','%Y-%m-%d')
  <dynamic >
  	<isNotNull prepend="," property="contractVersionId">#contractVersionId#</isNotNull>
    <isNotNull prepend="," property="contractId">#contractId#</isNotNull>
    <isNotNull prepend="," property="version">#version#</isNotNull>
    <isNotNull prepend="," property="state">#state#</isNotNull>
    <isNotNull prepend="," property="descriptor">#descriptor#</isNotNull>
    <isNotNull prepend="," property="isNeedCheck">#isNeedCheck#</isNotNull>
    <isNotNull prepend="," property="tenantId">#tenantId#</isNotNull>
    
  </dynamic>
  )
</insert>
<select id="selectContractVersion" parameterClass="com.ailk.eaap.op2.bo.ContractVersion" resultClass="com.ailk.eaap.op2.bo.ContractVersion">
  select CONTRACT_VERSION_ID CONTRACTVERSIONID,CONTRACT_ID CONTRACTID,VERSION VERSION, CREATE_TIME CREATETIME,STATE STATE,LASTEST_TIME LASTESTTIME,
  EFF_DATE EFFDATE,EXP_DATE EXPDATE,DESCRIPTOR DESCRIPTOR,IS_NEED_CHECK ISNEEDCHECK from contract_version
  <dynamic prepend="where">
    <isNotNull prepend="and" property="contractVersionId"> CONTRACT_VERSION_ID=#contractVersionId#</isNotNull>
    <isNotNull prepend="and" property="contractId"> CONTRACT_ID=#contractId#</isNotNull>
    <isNotNull prepend="and" property="version"> VERSION=#version#</isNotNull>
    <isNotNull prepend="and" property="createTime"> CREATE_TIME=#createTime#</isNotNull>
    <isNotNull prepend="and" property="state"> STATE=#state#</isNotNull>
    <isNotNull prepend="and" property="lastestTime"> LASTEST_TIME=#lastestTime#</isNotNull>
    <isNotNull prepend="and" property="effDate"> EFF_DATE=#effDate#</isNotNull>
    <isNotNull prepend="and" property="expDate"> EXP_DATE=#expDate#</isNotNull>
    <isNotNull prepend="and" property="descriptor"> DESCRIPTOR=#descriptor#</isNotNull>
    <isNotNull prepend="and" property="isNeedCheck"> IS_NEED_CHECK=#isNeedCheck#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</select>
<delete id="deleteContractFormat" parameterClass="com.ailk.eaap.op2.bo.ContractFormat">
  delete from contract_format
  <dynamic prepend="where">
    <isNotNull prepend="and" property="tcpCtrFId">TCP_CTR_F_ID=#tcpCtrFId#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</delete>
<update id="updateContractFormat" parameterClass="com.ailk.eaap.op2.bo.ContractFormat">
  update contract_format
  <dynamic prepend="set">
    <isNotNull prepend="," property="contractVersionId">CONTRACT_VERSION_ID=#contractVersionId#</isNotNull>
    <isNotNull prepend="," property="reqRsp">REQ_RSP=#reqRsp#</isNotNull>
    <isNotNull prepend="," property="conType">CON_TYPE=#conType#</isNotNull>
    <isNotNull prepend="," property="xsdHeaderFor">XSD_HEADER_FOR=#xsdHeaderFor#</isNotNull>
    <isNotNull prepend="," property="xsdFormat">XSD_FORMAT=#xsdFormat#</isNotNull>
    <isNotNull prepend="," property="xsdDemo">XSD_DEMO=#xsdDemo#</isNotNull>
    <isNotNull prepend="," property="createTime">CREATE_TIME=#createTime#</isNotNull>
    <isNotNull prepend="," property="state">STATE=#state#</isNotNull>
    <isNotNull prepend="," property="lastestTime">LASTEST_TIME=#lastestTime#</isNotNull>
    <isNotNull prepend="," property="descriptor">DESCRIPTOR=#descriptor#</isNotNull>
    <isNotNull prepend="," property="xsdException">XSD_EXCEPTION=#xsdException#</isNotNull>
  </dynamic>
  <dynamic prepend="where">
    <isNotNull prepend="and" property="tcpCtrFId">TCP_CTR_F_ID=#tcpCtrFId#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</update>
<insert id="insertContractFormat" parameterClass="com.ailk.eaap.op2.bo.ContractFormat">
<selectKey resultClass="int" keyProperty="tcpCtrFId">
	SELECT nextval('SEQ_CONTRACT_FORMAT');
  </selectKey>
    insert into contract_format (CREATE_TIME,LASTEST_TIME,CONTRACT_FORMAT_CODE
  <dynamic >
  	<isNotNull prepend="," property="tcpCtrFId">TCP_CTR_F_ID</isNotNull>
    <isNotNull prepend="," property="contractVersionId">CONTRACT_VERSION_ID</isNotNull>
    <isNotNull prepend="," property="reqRsp">REQ_RSP</isNotNull>
    <isNotNull prepend="," property="conType">CON_TYPE</isNotNull>
    <isNotNull prepend="," property="xsdHeaderFor">XSD_HEADER_FOR</isNotNull>
    <isNotNull prepend="," property="xsdFormat">XSD_FORMAT</isNotNull>
    <isNotNull prepend="," property="xsdDemo">XSD_DEMO</isNotNull>
    <isNotNull prepend="," property="state">STATE</isNotNull>
    <isNotNull prepend="," property="descriptor">DESCRIPTOR</isNotNull>
    <isNotNull prepend="," property="tenantId"> TENANT_ID</isNotNull>
  </dynamic>
  )values (utc_timestamp(),utc_timestamp(),uuid()
  <dynamic>
  	<isNotNull prepend="," property="tcpCtrFId">#tcpCtrFId#</isNotNull>
    <isNotNull prepend="," property="contractVersionId">#contractVersionId#</isNotNull>
    <isNotNull prepend="," property="reqRsp">#reqRsp#</isNotNull>
    <isNotNull prepend="," property="conType">#conType#</isNotNull>
    <isNotNull prepend="," property="xsdHeaderFor">#xsdHeaderFor#</isNotNull>
    <isNotNull prepend="," property="xsdFormat">#xsdFormat#</isNotNull>
    <isNotNull prepend="," property="xsdDemo">#xsdDemo#</isNotNull>
    <isNotNull prepend="," property="state">#state#</isNotNull>
    <isNotNull prepend="," property="descriptor">#descriptor#</isNotNull>
    <isNotNull prepend="," property="tenantId">#tenantId#</isNotNull>
  </dynamic>
  )
</insert>
<select id="selectContractFormat" parameterClass="com.ailk.eaap.op2.bo.ContractFormat" resultClass="com.ailk.eaap.op2.bo.ContractFormat">
  SELECT REQ_RSP REQRSP, TCP_CTR_F_ID TCPCTRFID, CON_TYPE  CONTYPE, XSD_HEADER_FOR XSDHEADERFOR, XSD_FORMAT  XSDFORMAT, XSD_DEMO  XSDDEMO, 
  DESCRIPTOR DESCRIPTOR,CONTRACT_VERSION_ID contractVersionId from contract_format
  <dynamic prepend="where">
    <isNotNull prepend="and" property="tcpCtrFId"> TCP_CTR_F_ID=#tcpCtrFId#</isNotNull>
    <isNotNull prepend="and" property="contractVersionId"> CONTRACT_VERSION_ID=#contractVersionId#</isNotNull>
    <isNotNull prepend="and" property="reqRsp"> REQ_RSP=#reqRsp#</isNotNull>
    <isNotNull prepend="and" property="conType"> CON_TYPE=#conType#</isNotNull>
    <isNotNull prepend="and" property="xsdHeaderFor"> XSD_HEADER_FOR=#xsdHeaderFor#</isNotNull>
    <isNotNull prepend="and" property="xsdFormat"> XSD_FORMAT=#xsdFormat#</isNotNull>
    <isNotNull prepend="and" property="xsdDemo"> XSD_DEMO=#xsdDemo#</isNotNull>
    <isNotNull prepend="and" property="createTime">CREATE_TIME=#createTime#</isNotNull>
    <isNotNull prepend="and" property="state"> STATE=#state#</isNotNull>
    <isNotNull prepend="and" property="lastestTime"> LASTEST_TIME=#lastestTime#</isNotNull>
    <isNotNull prepend="and" property="descriptor"> DESCRIPTOR=#descriptor#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</select>
<insert id="insertService" parameterClass="com.ailk.eaap.op2.bo.Service">
  <selectKey resultClass="int" keyProperty="serviceId">
    SELECT nextval('SEQ_SERVICE');
  </selectKey>
    insert into service (CREATE_DATE,LASTEST_DATE
  <dynamic >
    <isNotNull prepend="," property="serviceId">SERVICE_ID</isNotNull>
    <isNotNull prepend="," property="contractVersionId">CONTRACT_VERSION_ID</isNotNull>
    <isNotNull prepend="," property="serviceCnName">SERVICE_CN_NAME</isNotNull>
    <isNotNull prepend="," property="serviceEnName">SERVICE_EN_NAME</isNotNull>
    <isNotNull prepend="," property="serviceCode">SERVICE_CODE</isNotNull>
    <isNotNull prepend="," property="serviceType">SERVICE_TYPE</isNotNull>
    <isNotNull prepend="," property="serviceVersion">SERVICE_VERSION</isNotNull>
    <isNotNull prepend="," property="state">STATE</isNotNull>
    <isNotNull prepend="," property="serviceDesc">SERVICE_DESC</isNotNull>
    <isNotNull prepend="," property="isPublished">IS_PUBLISHED</isNotNull>
    <isNotNull prepend="," property="servicePriority">SERVICE_PRIORITY</isNotNull>
    <isNotNull prepend="," property="serviceTimeout">SERVICE_TIMEOUT</isNotNull>
    <isNotNull prepend="," property="tenantId"> TENANT_ID</isNotNull>
	</dynamic>
  	)values (utc_timestamp(),utc_timestamp()
  	<dynamic>
  	<isNotNull prepend="," property="serviceId">#serviceId#</isNotNull>
    <isNotNull prepend="," property="contractVersionId">#contractVersionId#</isNotNull>
    <isNotNull prepend="," property="serviceCnName">#serviceCnName#</isNotNull>
    <isNotNull prepend="," property="serviceEnName">#serviceEnName#</isNotNull>
    <isNotNull prepend="," property="serviceCode">#serviceCode#</isNotNull>
    <isNotNull prepend="," property="serviceType">#serviceType#</isNotNull>
    <isNotNull prepend="," property="serviceVersion">#serviceVersion#</isNotNull>
    <isNotNull prepend="," property="state">#state#</isNotNull>
    <isNotNull prepend="," property="serviceDesc">#serviceDesc#</isNotNull>
    <isNotNull prepend="," property="isPublished">#isPublished#</isNotNull>
    <isNotNull prepend="," property="servicePriority">#servicePriority#</isNotNull>
    <isNotNull prepend="," property="serviceTimeout">#serviceTimeout#</isNotNull>
    <isNotNull prepend="," property="tenantId">#tenantId#</isNotNull>
  </dynamic>
  )
</insert>
<select id="selectService" parameterClass="com.ailk.eaap.op2.bo.Service" resultClass="com.ailk.eaap.op2.bo.Service">
  select SERVICE_ID SERVICEID, CONTRACT_VERSION_ID CONTRACTVERSIONID, SERVICE_CN_NAME SERVICECNNAME, SERVICE_EN_NAME SERVICEENNAME,
  SERVICE_CODE SERVICECODE,SERVICE_TYPE SERVICETYPE,SERVICE_VERSION SERVICEVERSION,CREATE_DATE CREATEDATE,STATE STATE,LASTEST_DATE LASTESTDATE,
  SERVICE_DESC SERVICEDESC,IS_PUBLISHED ISPUBLISHED,SERVICE_PRIORITY SERVICEPRIORITY,SERVICE_TIMEOUT SERVICETIMEOUT from service
  <dynamic prepend="where">
    <isNotNull prepend="and" property="serviceId"> SERVICE_ID=#serviceId#</isNotNull>
    <isNotNull prepend="and" property="contractVersionId"> CONTRACT_VERSION_ID=#contractVersionId#</isNotNull>
    <isNotNull prepend="and" property="serviceCnName"> SERVICE_CN_NAME=#serviceCnName#</isNotNull>
    <isNotNull prepend="and" property="serviceEnName"> SERVICE_EN_NAME=#serviceEnName#</isNotNull>
    <isNotNull prepend="and" property="serviceCode"> SERVICE_CODE=#serviceCode#</isNotNull>
    <isNotNull prepend="and" property="serviceType"> SERVICE_TYPE=#serviceType#</isNotNull>
    <isNotNull prepend="and" property="serviceVersion"> SERVICE_VERSION=#serviceVersion#</isNotNull>
    <isNotNull prepend="and" property="createDate"> CREATE_DATE=#createDate#</isNotNull>
    <isNotNull prepend="and" property="state"> STATE=#state#</isNotNull>
    <isNotNull prepend="and" property="lastestDate"> LASTEST_DATE=#lastestDate#</isNotNull>
    <isNotNull prepend="and" property="serviceDesc"> SERVICE_DESC=#serviceDesc#</isNotNull>
    <isNotNull prepend="and" property="isPublished"> IS_PUBLISHED=#isPublished#</isNotNull>
    <isNotNull prepend="and" property="servicePriority"> SERVICE_PRIORITY=#servicePriority#</isNotNull>
    <isNotNull prepend="and" property="serviceTimeout"> SERVICE_TIMEOUT=#serviceTimeout#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</select>
<update id="updateService" parameterClass="com.ailk.eaap.op2.bo.Service">
  update service
  <dynamic prepend="set">
    <isNotNull prepend="," property="contractVersionId">CONTRACT_VERSION_ID=#contractVersionId#</isNotNull>
    <isNotNull prepend="," property="serviceCnName">SERVICE_CN_NAME=#serviceCnName#</isNotNull>
    <isNotNull prepend="," property="serviceEnName">SERVICE_EN_NAME=#serviceEnName#</isNotNull>
    <isNotNull prepend="," property="serviceCode">SERVICE_CODE=#serviceCode#</isNotNull>
    <isNotNull prepend="," property="serviceType">SERVICE_TYPE=#serviceType#</isNotNull>
    <isNotNull prepend="," property="serviceVersion">SERVICE_VERSION=#serviceVersion#</isNotNull>
    <isNotNull prepend="," property="createDate">CREATE_DATE=#createDate#</isNotNull>
    <isNotNull prepend="," property="state">STATE=#state#</isNotNull>
    <isNotNull prepend="," property="lastestDate">LASTEST_DATE=#lastestDate#</isNotNull>
    <isNotNull prepend="," property="serviceDesc">SERVICE_DESC=#serviceDesc#</isNotNull>
    <isNotNull prepend="," property="isPublished">IS_PUBLISHED=#isPublished#</isNotNull>
    <isNotNull prepend="," property="servicePriority">SERVICE_PRIORITY=#servicePriority#</isNotNull>
    <isNotNull prepend="," property="serviceTimeout">SERVICE_TIMEOUT=#serviceTimeout#</isNotNull>
  </dynamic>
  <dynamic prepend="where">
    <isNotNull prepend="and" property="serviceId">SERVICE_ID=#serviceId#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</update>
<insert id="insertDirSerList" parameterClass="com.ailk.eaap.op2.bo.DirSerList">
 <selectKey resultClass="int" keyProperty="dirSerListId">
	SELECT nextval('SEQ_DIR_SER_LIST');
  </selectKey>
    insert into dir_ser_list (CREATE_TIME,LASTEST_TIME
  <dynamic >
    <isNotNull prepend="," property="dirSerListId">DIR_SER_LIST_ID</isNotNull>
    <isNotNull prepend="," property="serviceId">SERVICE_ID</isNotNull>
    <isNotNull prepend="," property="dirId">DIR_ID</isNotNull>
    <isNotNull prepend="," property="state">STATE</isNotNull>
    <isNotNull prepend="," property="tenantId"> TENANT_ID</isNotNull>
  </dynamic>
  )values(utc_timestamp(),utc_timestamp()
  <dynamic>
    <isNotNull prepend="," property="dirSerListId">#dirSerListId#</isNotNull>
    <isNotNull prepend="," property="serviceId">#serviceId#</isNotNull>
    <isNotNull prepend="," property="dirId">#dirId#</isNotNull>
    <isNotNull prepend="," property="state">#state#</isNotNull>
    <isNotNull prepend="," property="tenantId">#tenantId#</isNotNull>
  </dynamic>
  )
</insert>
<update id="updateDirSerList" parameterClass="com.ailk.eaap.op2.bo.DirSerList">
  update dir_ser_list
  <dynamic prepend="set">
    <isNotNull prepend="," property="serviceId">SERVICE_ID=#serviceId#</isNotNull>
    <isNotNull prepend="," property="dirId">DIR_ID=#dirId#</isNotNull>
    <isNotNull prepend="," property="state">STATE=#state#</isNotNull>
    <isNotNull prepend="," property="createTime">CREATE_TIME=#createTime#</isNotNull>
    <isNotNull prepend="," property="lastestTime">LASTEST_TIME=#lastestTime#</isNotNull>
  </dynamic>
  <dynamic prepend="where">
    <isNotNull prepend="and" property="dirSerListId">DIR_SER_LIST_ID=#dirSerListId#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</update>
<insert id="insertServiceAtt" parameterClass="com.ailk.eaap.op2.bo.ServiceAtt">
  <selectKey resultClass="int" keyProperty="serviceAttId">
	SELECT nextval('SEQ_SERVICE_ATT');
  </selectKey>
    insert into service_att (CREATE_TIME,LASTEST_TIME
  <dynamic >
    <isNotNull prepend="," property="serviceAttId">SERVICE_ATT_ID</isNotNull>
    <isNotNull prepend="," property="serviceId">SERVICE_ID</isNotNull>
    <isNotNull prepend="," property="attrSpecId">ATTR_SPEC_ID</isNotNull>
    <isNotNull prepend="," property="serSpecVa">SER_SPEC_VA</isNotNull>
    <isNotNull prepend="," property="state">STATE</isNotNull>
    <isNotNull prepend="," property="tenantId"> TENANT_ID</isNotNull>
  </dynamic>
  )values(utc_timestamp(),utc_timestamp()
  <dynamic >
    <isNotNull prepend="," property="serviceAttId">#serviceAttId#</isNotNull>
    <isNotNull prepend="," property="serviceId">#serviceId#</isNotNull>
    <isNotNull prepend="," property="attrSpecId">#attrSpecId#</isNotNull>
    <isNotNull prepend="," property="serSpecVa">#serSpecVa#</isNotNull>
    <isNotNull prepend="," property="state">#state#</isNotNull>
    <isNotNull prepend="," property="tenantId">#tenantId#</isNotNull>
  </dynamic>
  )
</insert>
<insert id="insertNodeDesc" parameterClass="com.ailk.eaap.op2.bo.NodeDesc">
	<selectKey resultClass="int" keyProperty="nodeDescId">
		SELECT nextval('SEQ_NODE_DESC');
  	</selectKey>
    insert into node_desc (CREATE_TIME,LASTEST_TIME,NODE_DESC_CODE
  <dynamic >
    <isNotNull prepend="," property="nodeDescId">NODE_DESC_ID</isNotNull>
    <isNotNull prepend="," property="tcpCtrFId">TCP_CTR_F_ID</isNotNull>
    <isNotNull prepend="," property="nodeName">NODE_NAME</isNotNull>
    <isNotNull prepend="," property="nodeCode">NODE_CODE</isNotNull>
    <isNotNull prepend="," property="parentNodeId">PARENT_NODE_ID</isNotNull>
    <isNotNull prepend="," property="nodePath">NODE_PATH</isNotNull>
    <isNotNull prepend="," property="nodeType">NODE_TYPE</isNotNull>
    <isNotNull prepend="," property="nodeLengthCons">NODE_LENGTH_CONS</isNotNull>
    <isNotNull prepend="," property="nodeTypeCons">NODE_TYPE_CONS</isNotNull>
    <isNotNull prepend="," property="nodeNumberCons">NODE_NUMBER_CONS</isNotNull>
    <isNotNull prepend="," property="nevlConsType">NEVL_CONS_TYPE</isNotNull>
    <isNotNull prepend="," property="nevlConsValue">NEVL_CONS_VALUE</isNotNull>
    <isNotNull prepend="," property="isNeedCheck">IS_NEED_CHECK</isNotNull>
    <isNotNull prepend="," property="isNeedSign">IS_NEED_SIGN</isNotNull>
    <isNotNull prepend="," property="state">STATE</isNotNull>
    <isNotNull prepend="," property="description">DESCRIPTION</isNotNull>
    <isNotNull prepend="," property="javaField">JAVA_FIELD</isNotNull>
    <isNotNull prepend="," property="tenantId"> TENANT_ID</isNotNull>
  </dynamic>
  )values(utc_timestamp(),utc_timestamp(),uuid()
  <dynamic >
    <isNotNull prepend="," property="nodeDescId">#nodeDescId#</isNotNull>
    <isNotNull prepend="," property="tcpCtrFId">#tcpCtrFId#</isNotNull>
    <isNotNull prepend="," property="nodeName">#nodeName#</isNotNull>
    <isNotNull prepend="," property="nodeCode">#nodeCode#</isNotNull>
    <isNotNull prepend="," property="parentNodeId">#parentNodeId#</isNotNull>
    <isNotNull prepend="," property="nodePath">#nodePath#</isNotNull>
    <isNotNull prepend="," property="nodeType">#nodeType#</isNotNull>
    <isNotNull prepend="," property="nodeLengthCons">#nodeLengthCons#</isNotNull>
    <isNotNull prepend="," property="nodeTypeCons">#nodeTypeCons#</isNotNull>
    <isNotNull prepend="," property="nodeNumberCons">#nodeNumberCons#</isNotNull>
    <isNotNull prepend="," property="nevlConsType">#nevlConsType#</isNotNull>
    <isNotNull prepend="," property="nevlConsValue">#nevlConsValue#</isNotNull>
    <isNotNull prepend="," property="isNeedCheck">#isNeedCheck#</isNotNull>
    <isNotNull prepend="," property="isNeedSign">#isNeedSign#</isNotNull>
    <isNotNull prepend="," property="state">#state#</isNotNull>
    <isNotNull prepend="," property="description">#description#</isNotNull>
    <isNotNull prepend="," property="javaField">#javaField#</isNotNull>
    <isNotNull prepend="," property="tenantId">#tenantId#</isNotNull>
  </dynamic>
  )
</insert>
<update id="updateNodeDesc" parameterClass="com.ailk.eaap.op2.bo.NodeDesc" >
  update node_desc
  <dynamic prepend="set">
    <isNotNull prepend="," property="nodeName">NODE_NAME=#nodeName#</isNotNull>
    <isNotNull prepend="," property="nodeCode">NODE_CODE=#nodeCode#</isNotNull>
    <isNotNull prepend="," property="parentNodeId">PARENT_NODE_ID=#parentNodeId#</isNotNull>
    <isNotNull prepend="," property="nodePath">NODE_PATH=#nodePath#</isNotNull>
    <isNotNull prepend="," property="nodeType">NODE_TYPE=#nodeType#</isNotNull>
    <isNotNull prepend="," property="nodeLengthCons">NODE_LENGTH_CONS=#nodeLengthCons#</isNotNull>
    <isNotNull prepend="," property="nodeTypeCons">NODE_TYPE_CONS=#nodeTypeCons#</isNotNull>
    <isNotNull prepend="," property="nodeNumberCons">NODE_NUMBER_CONS=#nodeNumberCons#</isNotNull>
    <isNotNull prepend="," property="nevlConsType">NEVL_CONS_TYPE=#nevlConsType#</isNotNull>
    <isNotNull prepend="," property="nevlConsValue">NEVL_CONS_VALUE=#nevlConsValue#</isNotNull>
    <isNotNull prepend="," property="isNeedCheck">IS_NEED_CHECK=#isNeedCheck#</isNotNull>
    <isNotNull prepend="," property="isNeedSign"> IS_NEED_SIGN=#isNeedSign#</isNotNull>  
    <isNotNull prepend="," property="state">STATE=#state#</isNotNull>
    <isNotNull prepend="," property="createTime">CREATE_TIME=#createTime#</isNotNull>
    <isNotNull prepend="," property="lastestTime">LASTEST_TIME=#lastestTime#</isNotNull>
    <isNotNull prepend="," property="description">DESCRIPTION=#description#</isNotNull>
    <isNotNull prepend="," property="javaField">JAVA_FIELD=#javaField#</isNotNull>
  </dynamic>
  where NODE_DESC_ID=#nodeDescId# and TENANT_ID = #tenantId#
</update>
<select id="selectNodeDesc" parameterClass="com.ailk.eaap.op2.bo.NodeDesc" resultClass="com.ailk.eaap.op2.bo.NodeDesc">
  select NODE_DESC_ID NODEDESCID, TCP_CTR_F_ID TCPCTRFID, NODE_NAME NODENAME,NODE_CODE NODECODE,NODE_PATH NODEPATH, NODE_LENGTH_CONS NODELENGTHCONS, 
   NODE_TYPE_CONS NODETYPECONS, NODE_TYPE NODETYPE, NODE_NUMBER_CONS NODENUMBERCONS, NEVL_CONS_TYPE NEVLCONSTYPE, IS_NEED_CHECK ISNEEDCHECK, 
   IS_NEED_SIGN ISNEEDSIGN, STATE STATE, CREATE_TIME CREATETIME, LASTEST_TIME LASTESTTIME, DESCRIPTION DESCRIPTION,JAVA_FIELD JAVAFIELD from node_desc
  <dynamic prepend="where">
    <isNotNull prepend="and" property="nodeDescId"> NODE_DESC_ID=#nodeDescId#</isNotNull>
    <isNotNull prepend="and" property="tcpCtrFId"> TCP_CTR_F_ID=#tcpCtrFId#</isNotNull>
    <isNotNull prepend="and" property="nodeName"> NODE_NAME=#nodeName#</isNotNull>
    <isNotNull prepend="and" property="nodeCode"> NODE_CODE=#nodeCode#</isNotNull>
    <isNotNull prepend="and" property="nodePath"> NODE_PATH=#nodePath#</isNotNull>
    <isNotNull prepend="and" property="nodeLengthCons"> NODE_LENGTH_CONS=#nodeLengthCons#</isNotNull>
    <isNotNull prepend="and" property="nodeTypeCons"> NODE_TYPE_CONS=#nodeTypeCons#</isNotNull>
    <isNotNull prepend="and" property="nodeType"> NODE_TYPE=#nodeType#</isNotNull>
    <isNotNull prepend="and" property="nodeNumberCons"> NODE_NUMBER_CONS=#nodeNumberCons#</isNotNull>
    <isNotNull prepend="and" property="nevlConsType"> NEVL_CONS_TYPE=#nevlConsType#</isNotNull>
    <isNotNull prepend="and" property="nevlConsValue"> NEVL_CONS_VALUE=#nevlConsValue#</isNotNull>
    <isNotNull prepend="and" property="isNeedCheck"> IS_NEED_CHECK=#isNeedCheck#</isNotNull>
    <isNotNull prepend="and" property="isNeedSign"> IS_NEED_SIGN=#isNeedSign#</isNotNull>    
    <isNotNull prepend="and" property="state"> STATE=#state#</isNotNull>
    <isNotNull prepend="and" property="createTime"> CREATE_TIME=#createTime#</isNotNull>
    <isNotNull prepend="and" property="lastestTime"> LASTEST_TIME=#lastestTime#</isNotNull>
    <isNotNull prepend="and" property="description"> DESCRIPTION=#description#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</select>

<update id="updateDocContract" parameterClass="com.ailk.eaap.op2.bo.DocContract">
  update doc_contract
  <dynamic prepend="set">   
    <isNotNull prepend="," property="contractDocId">CONTRACT_DOC_ID=#contractDocId#</isNotNull>
    <isNotNull prepend="," property="contractVersionId">CONTRACT_VERSION_ID=#contractVersionId#</isNotNull>
    <isNotNull prepend="," property="descriptor">DESCRIPTOR=#descriptor#</isNotNull>
  </dynamic>
  <dynamic prepend="where">
    <isNotNull prepend="," property="docContrId">DOC_CONTR_ID=#docContrId#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</update>

<insert id="insertDocContract" parameterClass="com.ailk.eaap.op2.bo.DocContract">
   <selectKey resultClass="int" keyProperty="docContrId">
		SELECT nextval('SEQ_DOC_CONTRACT');
  	</selectKey>
  insert into doc_contract(
  <dynamic >
    <isNotNull prepend="" property="docContrId">DOC_CONTR_ID</isNotNull>
    <isNotNull prepend="," property="contractDocId">CONTRACT_DOC_ID</isNotNull>
    <isNotNull prepend="," property="contractVersionId">CONTRACT_VERSION_ID</isNotNull>
    <isNotNull prepend="," property="descriptor">DESCRIPTOR</isNotNull>
    <isNotNull prepend="," property="tenantId"> TENANT_ID</isNotNull>
  </dynamic>
  )values(
  <dynamic >
    <isNotNull prepend="" property="docContrId">#docContrId#</isNotNull>
    <isNotNull prepend="," property="contractDocId">#contractDocId#</isNotNull>
    <isNotNull prepend="," property="contractVersionId">#contractVersionId#</isNotNull>
    <isNotNull prepend="," property="descriptor">#descriptor#</isNotNull>
    <isNotNull prepend="," property="tenantId">#tenantId#</isNotNull>
  </dynamic>
  )
</insert>

<select id="selectDocContract" parameterClass="com.ailk.eaap.op2.bo.DocContract" resultClass="com.ailk.eaap.op2.bo.DocContract">
  SELECT DOC_CONTR_ID DOCCONTRID, CONTRACT_DOC_ID CONTRACTDOCID, CONTRACT_VERSION_ID CONTRACTVERSIONID, 
  DESCRIPTOR DESCRIPTOR from doc_contract
  <dynamic prepend="where">
    <isNotNull prepend="and" property="docContrId">DOC_CONTR_ID=#docContrId#</isNotNull>
    <isNotNull prepend="and" property="contractDocId">CONTRACT_DOC_ID=#contractDocId#</isNotNull>
    <isNotNull prepend="and" property="contractVersionId">CONTRACT_VERSION_ID=#contractVersionId#</isNotNull>
    <isNotNull prepend="and" property="descriptor">DESCRIPTOR=#descriptor#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
	GROUP BY DOC_CONTR_ID 
	ORDER BY count(1) 
	DESC LIMIT 1
</select>

<select id="selectContractDoc" parameterClass="com.ailk.eaap.op2.bo.ContractDoc" resultClass="com.ailk.eaap.op2.bo.ContractDoc">
	select CONTRACT_DOC_ID CONTRACTDOCID, BASE_CON_DOC_ID BASECONDOCID, DOC_NAME DOCNAME, DOC_VERSION DOCVERSION, DOC_CREATE_TIME DOCCREATETIME, 
           STATE STATE, DOC_PATH DOCPATH, LASTEST_TIME LASTESTTIME, DOC_TYPE docType from contract_doc
  <dynamic prepend="where">
    <isNotNull prepend="and" property="contractDocId"> CONTRACT_DOC_ID=#contractDocId#</isNotNull>
    <isNotNull prepend="and" property="baseConDocId"> BASE_CON_DOC_ID=#baseConDocId#</isNotNull>
    <isNotNull prepend="and" property="docName"> DOC_NAME=#docName#</isNotNull>
    <isNotNull prepend="and" property="docVersion"> DOC_VERSION=#docVersion#</isNotNull>
    <isNotNull prepend="and" property="docCreateTime"> DOC_CREATE_TIME=#docCreateTime#</isNotNull>
    <isNotNull prepend="and" property="state"> STATE=#state#</isNotNull>
    <isNotNull prepend="and" property="docPath"> DOC_PATH=#docPath#</isNotNull>
    <isNotNull prepend="and" property="lastestTime"> LASTEST_TIME=#lastestTime#</isNotNull>
    <isNotNull prepend="AND" property="tenantId"> TENANT_ID = #tenantId#</isNotNull>
  </dynamic>
</select>

<select id="selectComponentState" parameterClass="com.ailk.eaap.op2.bo.Component" resultClass="com.ailk.eaap.op2.bo.Component">
  select COMPONENT_ID COMPONENTID,ORG_ID ORGID,CODE CODE,NAME NAME,COMPONENT_TYPE_ID COMPONENTTYPEID,STATE STATE,
  STATE_TIME STATETIME, PASSWORD PASSWORD,REG_TIME REGTIME, S_FILE_ID SFILEID, DESCRIPTOR DESCRIPTOR from component
  where ORG_ID=#orgId# and STATE != 'X' and TENANT_ID = #tenantId#
</select>

<select id="chooseNodeDesc" parameterClass="java.util.HashMap" resultClass="java.util.HashMap">
	select *,
           (select node_name 
              from node_desc pnd 
             where pnd.node_desc_id = nd.parent_node_id) parent_node_name
      from node_desc nd
     where state = 'A'
       and tcp_ctr_f_id = #tcpCtrFId#
        and TENANT_ID = #tenantId#
    <dynamic>
    	<isNotNull prepend="and" property="nodeDescId"> NODE_DESC_ID != #nodeDescId#</isNotNull>
    	<isNotNull prepend="and" property="nodeCode"> NODE_CODE like concat('%',#nodeCode#,'%')</isNotNull>
   		<isNotNull prepend="and" property="nodeName"> NODE_NAME like concat('%',#nodeName#,'%')</isNotNull>
    </dynamic>  
     LIMIT #startPage_mysql#,#endPage_mysql#
</select>

	<select id="countChooseNodeDescSum" parameterClass="java.util.HashMap" resultClass="java.lang.Integer">
		select count(*)
	      from node_desc nd
	     where state = 'A'
	       and tcp_ctr_f_id = #tcpCtrFId#
	       and TENANT_ID = #tenantId#
	    <dynamic>
	    	<isNotNull prepend="and" property="nodeDescId"> NODE_DESC_ID!=#nodeDescId#</isNotNull>
	    	<isNotNull prepend="and" property="nodeCode"> NODE_CODE like concat('%',#nodeCode#,'%')</isNotNull>
    		<isNotNull prepend="and" property="nodeName"> NODE_NAME like concat('%',#nodeName#,'%')</isNotNull>
	    </dynamic>  
	</select>
	
	<delete id="delNodeDesc" parameterClass="java.util.HashMap">
 		 delete from node_desc where node_desc_id = #nodeDescId# and TENANT_ID=#tenantId#
	</delete>


	<!-- 保存消息流 -->
	<insert id="saveMessageFlow" parameterClass="java.util.HashMap">
		insert into
		message_flow
		(message_flow_id, message_flow_name, first_endpoint_id,
		create_time, state,
		lastest_time, descriptor,TENANT_ID)
		values
		(#message_Flow_Id#,
		#message_Flow_Name#,
		IF(#first_Endpoint_Id#='',NULL,#first_Endpoint_Id#), now(), #state#,
		IF(#lastest_Time#='',NULL,STR_TO_DATE(REPLACE(#lastest_Time#,'/','-'),'%Y-%m-%d
		%H:%i:%s')), #descriptor#,#tenantId#)
	</insert>
	<!-- 保存端点-->
	<insert id="saveEndpoint" parameterClass="java.util.HashMap" >
		insert into endpoint
		  (endpoint_id,endpoint_spec_id,in_data_type_id,out_data_type_id,endpoint_name,
		   endpoint_code,enable_in_trace,enable_out_trace,enable_in_log,enable_out_log,
		   create_date,state,lastest_date,endpoint_desc,map_code,TENANT_ID)
		values
		  (#endpoint_Id#,#endpoint_Spec_Id#,#in_Data_Type_Id#,#out_Data_Type_Id#,#endpoint_Name#,
		   #endpoint_Code#,#enable_In_Trace#,#enable_Out_Trace#,#enable_In_Log#,#enable_Out_Log#,
		   now(),#state#,str_to_date(#lastest_Date#,'%Y-%m-%d %H:%i:%s'),#endpoint_Desc#,#map_Code#,#tenantId#)
	</insert>
	<!-- 保存端点规格属性值-->
	<insert id="saveEndpointAttrValue" parameterClass="java.util.HashMap" >
		insert into endpoint_attr_value
		  (endpoint_attr_value_id,endpoint_id,endpoint_spec_attr_id,attr_value,long_attr_value,TENANT_ID)
		values
		  (nextval('SEQ_ENDPOINT_ATTR_VAL'),#endpoint_Id#,#endpoint_Spec_Attr_Id#,#attr_Value#,#long_Attr_Value#,#tenantId#)
	</insert>	
	<!-- 保存消息流路径-->
	<insert id="saveService_Route_Config" parameterClass="java.util.HashMap" >
		insert into service_route_config
		  (route_id, route_policy_id, from_endpoint_id, to_endpoint_id, message_flow_id, 
		   syn_asyn, state, create_date, lastest_date, map_Code,service_route_config_code,TENANT_ID)
		values
		  (#route_Id#, #route_Policy_Id#, #from_Endpoint_Id#, #to_Endpoint_Id#, #message_Flow_Id#,
		   #syn_Asyn#, #state#, now(), now(), #map_Code#,uuid(),#tenantId#)		
	</insert>	
	<!-- 新增路由规则 -->
	<insert id="addRoutePolicy" parameterClass="java.util.HashMap" >
		insert into route_policy
			(route_policy_id, rule_strategy_id, route_cond_id,ROUTE_POLICY_CODE,TENANT_ID)
		values
			(#route_Policy_Id#, #rule_Strategy_Id#, IF(#route_Cond_Id#='',NULL,#route_Cond_Id#),uuid(),#tenantId#)		
	</insert>	
	 
	<!--服务的默认消息流更新为新创建的透传消息流 -->
	<update  id="updateServiceDefaultMsgFlow" parameterClass="java.util.HashMap">
	  update SERVICE set DEFAULT_MSG_FLOW = #messageFlowId# where SERVICE_ID in (select i.SERVICE_ID from SER_TECH_IMPL i where i.SER_TECH_IMPL_ID=#serTechImplId# and  i.TENANT_ID = #tenantId#)and  TENANT_ID = #tenantId#
	 </update>

	<!--获取主键ID -->
	<select id="getSeq" parameterClass="java.util.Map" resultClass="java.lang.Integer" remapResults="true" >
		select nextval('$sequenceName$') from dual;
	</select>
	
</sqlMap>
